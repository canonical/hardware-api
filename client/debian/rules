#!/usr/bin/make -f

%:
	dh $@ --with python3,rust

override_dh_auto_clean:
	dh_auto_clean
	cargo clean
	-rm -rf target/release build

override_dh_auto_build:
	dh_auto_build
	# Build the Rust library
	cargo build --release --lib
	# Build the Python bindings with maturin
	maturin build --release --out target/release -b pyo3 --no-sdist

override_dh_auto_install:
	dh_auto_install
	# Install the Rust library
	install -Dm755 target/release/libhwlib.so debian/hwlib/usr/lib/$(DEB_HOST_MULTIARCH)/
	# Install the Python bindings generated by maturin
	install -Dm755 target/release/*.whl debian/hwlib/usr/lib/python3/dist-packages/

