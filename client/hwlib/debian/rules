#!/usr/bin/make -f

%:
	dh $@

override_dh_auto_clean:
	dh_auto_clean
	cargo clean
	rm -rf target/release build

override_dh_auto_build:
	dh_auto_build
	# Build the Rust library
	cargo build --release --lib
	# Build the Python bindings with maturin
	pipx run maturin build --release --out target/release -b pyo3

override_dh_auto_install:
	dh_auto_install
	mkdir -p debian/hwlib/usr/lib/$(DEB_HOST_MULTIARCH)
	mkdir -p debian/hwlib/usr/lib/python3/dist-packages
	# Install the Rust library
	cp ../../target/release/libhwlib.so debian/hwlib/usr/lib/$(DEB_HOST_MULTIARCH)/
	# Install the Python bindings generated by maturin
	cp target/release/*.whl debian/hwlib/usr/lib/python3/dist-packages/

